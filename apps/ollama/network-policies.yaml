apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: default-deny-ingress
  namespace: ollama
spec:
  podSelector: {}
  policyTypes:
  - Ingress
---
# Allow ingress controller for external API access
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-ingress-nginx
  namespace: ollama
spec:
  podSelector:
    matchLabels:
      app: ollama
  policyTypes:
  - Ingress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: ingress-nginx
    ports:
    - port: 11434
---
# Allow Open WebUI to call Ollama
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-open-webui
  namespace: ollama
spec:
  podSelector:
    matchLabels:
      app: ollama
  policyTypes:
  - Ingress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: open-webui
    ports:
    - port: 11434
---
# Allow PlatformStore AI service to call Ollama
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-platform-store
  namespace: ollama
spec:
  podSelector:
    matchLabels:
      app: ollama
  policyTypes:
  - Ingress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: platform-store
    ports:
    - port: 11434
---
# Allow chatbot to call Ollama
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-chatbot
  namespace: ollama
spec:
  podSelector:
    matchLabels:
      app: ollama
  policyTypes:
  - Ingress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: chatbot
    ports:
    - port: 11434
---
# Allow monitoring/Prometheus scraping
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-monitoring
  namespace: ollama
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: monitoring
